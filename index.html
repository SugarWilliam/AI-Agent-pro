<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, minimum-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#000000">
    <title>AI Agent Pro v8.2.1</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🤖</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="stylesheet" href="css/style-new.css">
</head>
<body>
    <div id="app">
        <!-- 启动页 -->
        <div id="splash" class="splash-screen">
            <div class="splash-content">
                <div class="splash-logo">
                    <i class="fas fa-robot"></i>
                </div>
                <h1 class="splash-title">AI Agent Pro</h1>
                <p class="splash-subtitle">智能助手，未来已来</p>
                <p class="splash-version">v8.2.1</p>
                <div class="splash-loading">
                    <div class="splash-loading-bar" id="splash-loading-bar"></div>
                </div>
                <div class="splash-loading-text" id="splash-loading-text">正在初始化...</div>
                <div class="splash-features">
                    <div class="splash-feature"><i class="fas fa-brain"></i> 多模型支持</div>
                    <div class="splash-feature"><i class="fas fa-user-astronaut"></i> 智能助手</div>
                    <div class="splash-feature"><i class="fas fa-database"></i> RAG知识库</div>
                    <div class="splash-feature"><i class="fas fa-tasks"></i> 任务管理</div>
                    <div class="splash-feature"><i class="fas fa-chart-line"></i> 数据分析</div>
                    <div class="splash-feature"><i class="fas fa-magic"></i> 创意生成</div>
                </div>
            </div>
        </div>

        <!-- 侧边栏 - 重构布局 -->
        <aside id="sidebar" class="sidebar">
            <!-- 顶部区域：Logo、版本、用户 -->
            <div class="sidebar-top">
                <div class="sidebar-brand">
                    <div class="brand-logo">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="brand-info">
                        <div class="brand-name">AI Agent Pro</div>
                        <div class="brand-version">v8.2.1</div>
                    </div>
                </div>
                <button id="close-sidebar" class="close-sidebar-btn">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>
            
            <!-- 用户入口 -->
            <div class="sidebar-user">
                <div class="user-avatar">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="user-info">
                    <div class="user-name">访客用户</div>
                    <div class="user-status">
                        <span class="status-dot online"></span>
                        <span>在线</span>
                    </div>
                </div>
                <button id="settings-btn" class="user-settings-btn" title="设置">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
            
            <!-- 功能摘要 - 文字展示 -->
            <div class="sidebar-features-text">
                <div class="feature-tag"><i class="fas fa-brain"></i> 多模型</div>
                <div class="feature-tag"><i class="fas fa-user-astronaut"></i> 智能助手</div>
                <div class="feature-tag"><i class="fas fa-database"></i> RAG知识库</div>
                <div class="feature-tag"><i class="fas fa-tasks"></i> 任务计划</div>
            </div>
            
            <!-- 文档下载入口 -->
            <div class="sidebar-docs">
                <a href="docs/DESIGN.md" target="_blank" class="doc-link">
                    <i class="fas fa-book"></i>
                    <span>设计文档</span>
                </a>
                <a href="docs/DEPLOYMENT.md" target="_blank" class="doc-link">
                    <i class="fas fa-file-code"></i>
                    <span>部署文档</span>
                </a>
                <a href="docs/AI-Agent-Pro-Features.html" target="_blank" class="doc-link">
                    <i class="fas fa-book-open"></i>
                    <span>功能说明书</span>
                </a>
                <a href="https://github.com/yourusername/ai-agent-pro/archive/refs/heads/main.zip" download class="doc-link">
                    <i class="fas fa-download"></i>
                    <span>下载源码</span>
                </a>
            </div>
            
            <!-- 新建对话按钮 -->
            <div class="sidebar-new-chat">
                <button id="new-chat-btn" class="new-chat-btn">
                    <i class="fas fa-plus"></i>
                    <span>新建对话</span>
                </button>
            </div>
            
            <!-- 对话历史 -->
            <div class="sidebar-section">
                <h3 class="sidebar-section-title">
                    <i class="fas fa-history"></i>
                    <span>对话历史</span>
                </h3>
                <div id="chat-history" class="chat-history"></div>
            </div>
        </aside>

        <!-- 侧边栏遮罩 -->
        <div id="sidebar-overlay" class="sidebar-overlay"></div>

        <!-- 主内容区 -->
        <main class="main-content">
            <!-- 顶部导航 -->
            <header class="header">
                <button id="menu-btn" class="btn-icon menu-btn" title="打开菜单">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="header-center">
                    <button id="subagent-btn" class="status-bar agent-selector-btn" title="选择助手">
                        <i class="fas fa-user-astronaut"></i>
                        <span id="current-agent-name">通用助手</span>
                        <span id="current-mode-badge" class="mode-badge">对话</span>
                    </button>
                </div>
                <button id="model-selector-btn" class="model-selector">
                    <i class="fas fa-brain"></i>
                    <span id="current-model">Auto</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
            </header>

            <!-- 消息区域 -->
            <div id="messages-container" class="messages-container">
                <!-- 欢迎页面 -->
                <div id="welcome-screen" class="welcome-screen">
                    <div class="welcome-logo">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h2 class="welcome-title">有什么可以帮您的？</h2>
                    <p class="welcome-subtitle">选择一个AI助手开始对话</p>
                    <div class="quick-actions">
                        <div class="quick-action" data-prompt="帮我写一篇文章">
                            <i class="fas fa-pen"></i>
                            <span>写文章</span>
                        </div>
                        <div class="quick-action" data-prompt="帮我分析数据">
                            <i class="fas fa-chart-line"></i>
                            <span>数据分析</span>
                        </div>
                        <div class="quick-action" data-prompt="帮我制定计划">
                            <i class="fas fa-calendar-alt"></i>
                            <span>制定计划</span>
                        </div>
                        <div class="quick-action" data-prompt="帮我写代码">
                            <i class="fas fa-code"></i>
                            <span>写代码</span>
                        </div>
                    </div>
                </div>
                <!-- 消息列表 -->
                <div id="messages-list" class="messages-list"></div>
            </div>

            <!-- 输入区域 -->
            <div class="input-area">
                <!-- 模式选择器 - 胶囊分段控制器（合并工具箱和搜索） -->
                <div class="mode-selector-container">
                    <div class="mode-selector">
                        <button class="mode-option active" data-mode="chat">
                            <i class="fas fa-comments"></i>
                            <span>对话</span>
                        </button>
                        <button class="mode-option" data-mode="task">
                            <i class="fas fa-tasks"></i>
                            <span>任务</span>
                        </button>
                        <button class="mode-option" data-mode="plan">
                            <i class="fas fa-calendar-alt"></i>
                            <span>计划</span>
                        </button>
                        <button class="mode-option" data-mode="creative">
                            <i class="fas fa-magic"></i>
                            <span>创意</span>
                        </button>
                        <button class="mode-option" data-mode="writing">
                            <i class="fas fa-pen"></i>
                            <span>创作</span>
                        </button>
                    </div>
                    <div class="mode-selector-right">
                        <button class="mode-option web-search" id="search-btn" title="网络搜索">
                            <i class="fas fa-globe"></i>
                        </button>
                        <button class="mode-option" id="tools-btn" title="工具箱">
                            <i class="fas fa-toolbox"></i>
                        </button>
                    </div>
                </div>
                <!-- 文件附件显示区域（移到输入框上方） -->
                <div id="file-attachments-container" class="file-attachments-container">
                    <div id="file-attachments" class="file-attachments"></div>
                </div>
                <!-- 输入框 -->
                <div class="input-box-container">
                    <button class="toolbar-btn voice-input-btn" id="voice-btn" title="语音输入">
                        <i class="fas fa-microphone"></i>
                    </button>
                    <textarea id="message-input" class="message-input" placeholder="输入消息..." rows="1"></textarea>
                    <button class="toolbar-btn attachment-btn" id="upload-btn" title="上传文件/图片">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button id="send-btn" class="send-btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- ========== 模态框 ========== -->

    <!-- 通用模态框 -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">标题</h3>
                <button class="modal-close" onclick="AIAgentUI.closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="modal-body" class="modal-body"></div>
            <div id="modal-footer" class="modal-footer"></div>
        </div>
    </div>

    <!-- SubAgent选择模态框 -->
    <div id="subagent-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-astronaut"></i> 选择AI助手</h3>
                <button class="modal-close" onclick="AIAgentUI.closeModal('subagent-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="subagent-list" class="subagent-list"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="AIAgentUI.closeModal('subagent-modal')">关闭</button>
                <button class="btn btn-primary" id="add-custom-subagent-btn">
                    <i class="fas fa-plus"></i> 添加助手
                </button>
            </div>
        </div>
    </div>

    <!-- 模型选择模态框 -->
    <div id="model-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-brain"></i> 选择模型</h3>
                <button class="modal-close" onclick="AIAgentUI.closeModal('model-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="model-selector-options" class="model-selector-options"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="AIAgentUI.closeModal('model-modal')">关闭</button>
                <button class="btn btn-primary" id="add-custom-model-btn">
                    <i class="fas fa-plus"></i> 添加模型
                </button>
            </div>
        </div>
    </div>

    <!-- 设置模态框 - 左侧菜单右侧内容布局 -->
    <div id="settings-modal" class="modal settings-modal">
        <div class="modal-content settings-content">
            <div class="modal-header settings-header">
                <h3><i class="fas fa-cog"></i> 设置</h3>
                <button class="modal-close" onclick="AIAgentUI.closeModal('settings-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="settings-layout">
                <!-- 左侧菜单 -->
                <div class="settings-sidebar">
                    <div class="settings-menu">
                        <div class="settings-menu-item active" data-tab="general">
                            <div class="menu-icon"><i class="fas fa-sliders-h"></i></div>
                            <div class="menu-text">
                                <div class="menu-title">通用</div>
                                <div class="menu-desc">主题、语言、快捷键</div>
                            </div>
                        </div>
                        <div class="settings-menu-item" data-tab="models">
                            <div class="menu-icon"><i class="fas fa-brain"></i></div>
                            <div class="menu-text">
                                <div class="menu-title">模型</div>
                                <div class="menu-desc">AI模型配置</div>
                            </div>
                        </div>
                        <div class="settings-menu-item" data-tab="resources">
                            <div class="menu-icon"><i class="fas fa-database"></i></div>
                            <div class="menu-text">
                                <div class="menu-title">资源</div>
                                <div class="menu-desc">RAG、技能、MCP</div>
                            </div>
                        </div>
                        <div class="settings-menu-item" data-tab="subagents">
                            <div class="menu-icon"><i class="fas fa-user-astronaut"></i></div>
                            <div class="menu-text">
                                <div class="menu-title">助手</div>
                                <div class="menu-desc">SubAgent管理</div>
                            </div>
                        </div>
                        <div class="settings-menu-item" data-tab="sync">
                            <div class="menu-icon"><i class="fas fa-sync"></i></div>
                            <div class="menu-text">
                                <div class="menu-title">同步</div>
                                <div class="menu-desc">数据同步配置</div>
                            </div>
                        </div>
                        <div class="settings-menu-item" data-tab="jina">
                            <div class="menu-icon"><i class="fas fa-file-alt"></i></div>
                            <div class="menu-text">
                                <div class="menu-title">Jina AI</div>
                                <div class="menu-desc">文档解析配置</div>
                            </div>
                        </div>
                        <div class="settings-menu-item" data-tab="data">
                            <div class="menu-icon"><i class="fas fa-database"></i></div>
                            <div class="menu-text">
                                <div class="menu-title">数据</div>
                                <div class="menu-desc">导入导出管理</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 右侧内容区 -->
                <div class="settings-body">
                    <!-- 通用设置 -->
                    <div id="settings-general" class="settings-panel active">
                        <div class="settings-section-title"><i class="fas fa-sliders-h"></i> 通用设置</div>
                        <div class="form-group">
                            <label class="form-label">主题</label>
                            <div class="theme-options">
                                <div class="theme-option active" data-theme="dark">
                                    <i class="fas fa-moon"></i>
                                    <span>深色</span>
                                </div>
                                <div class="theme-option" data-theme="light">
                                    <i class="fas fa-sun"></i>
                                    <span>浅色</span>
                                </div>
                                <div class="theme-option" data-theme="auto">
                                    <i class="fas fa-adjust"></i>
                                    <span>自动</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">语言</label>
                            <select id="setting-language" class="form-select">
                                <option value="zh-CN">简体中文</option>
                                <option value="en">English</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">发送快捷键</label>
                            <select id="setting-shortcut" class="form-select">
                                <option value="enter">Enter</option>
                                <option value="ctrl-enter">Ctrl + Enter</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">字体大小</label>
                            <select id="setting-font-size" class="form-select">
                                <option value="small">小</option>
                                <option value="medium" selected>中</option>
                                <option value="large">大</option>
                            </select>
                        </div>
                    </div>

                    <!-- 模型设置 -->
                    <div id="settings-models" class="settings-panel">
                        <div class="settings-section-title"><i class="fas fa-brain"></i> 模型设置</div>
                        <div id="models-list" class="models-list"></div>
                    </div>

                    <!-- 资源设置 -->
                    <div id="settings-resources" class="settings-panel">
                        <div class="settings-section-title"><i class="fas fa-database"></i> 资源管理</div>
                        <div class="resource-subtabs">
                            <button class="resource-subtab active" data-subtab="rag">
                                <i class="fas fa-book"></i> RAG
                            </button>
                            <button class="resource-subtab" data-subtab="skills">
                                <i class="fas fa-magic"></i> 技能
                            </button>
                            <button class="resource-subtab" data-subtab="mcp">
                                <i class="fas fa-plug"></i> MCP
                            </button>
                            <button class="resource-subtab" data-subtab="rules">
                                <i class="fas fa-list-check"></i> 规则
                            </button>
                        </div>
                        <div id="resources-rag" class="resources-subpanel active">
                            <div id="rag-list" class="resource-list"></div>
                            <button class="btn btn-primary" id="add-rag-btn">
                                <i class="fas fa-plus"></i> 添加知识库
                            </button>
                        </div>
                        <div id="resources-skills" class="resources-subpanel">
                            <div id="skills-list" class="resource-list"></div>
                            <button class="btn btn-primary" id="add-skill-btn">
                                <i class="fas fa-plus"></i> 添加技能
                            </button>
                        </div>
                        <div id="resources-mcp" class="resources-subpanel">
                            <div id="mcp-list" class="resource-list"></div>
                            <button class="btn btn-primary" id="add-mcp-btn">
                                <i class="fas fa-plus"></i> 添加MCP
                            </button>
                        </div>
                        <div id="resources-rules" class="resources-subpanel">
                            <div id="rules-list" class="resource-list"></div>
                            <button class="btn btn-primary" id="add-rule-btn">
                                <i class="fas fa-plus"></i> 添加规则
                            </button>
                        </div>
                    </div>

                    <!-- SubAgent设置 -->
                    <div id="settings-subagents" class="settings-panel">
                        <div class="settings-section-title"><i class="fas fa-user-astronaut"></i> 助手管理</div>
                        <div id="subagents-list" class="subagents-list"></div>
                        <button class="btn btn-primary" id="add-subagent-btn">
                            <i class="fas fa-plus"></i> 添加助手
                        </button>
                    </div>

                    <!-- 同步设置 -->
                    <div id="settings-sync" class="settings-panel">
                        <div class="settings-section-title"><i class="fas fa-sync"></i> 同步设置</div>
                        <form id="sync-form" onsubmit="return false;">
                            <div class="form-group">
                                <label class="form-label">服务器地址</label>
                                <input type="text" id="sync-server-url" class="form-input" placeholder="https://sync.example.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label">API密钥</label>
                                <input type="password" id="sync-api-key" class="form-input" placeholder="your-api-key" autocomplete="off">
                            </div>
                            <div class="form-group">
                                <label class="form-label">同步间隔（分钟）</label>
                                <input type="number" id="sync-interval" class="form-input" value="30" min="5" max="1440">
                            </div>
                            <div class="sync-status">
                                <span id="sync-status-text">未配置</span>
                                <span id="sync-last-time">上次同步: 从未</span>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" id="sync-test-btn">测试连接</button>
                                <button type="button" class="btn btn-primary" id="sync-save-btn">保存配置</button>
                                <button type="button" class="btn btn-primary" id="sync-now-btn">立即同步</button>
                            </div>
                        </form>
                    </div>

                    <!-- Jina AI设置 -->
                    <div id="settings-jina" class="settings-panel">
                        <div class="settings-section-title"><i class="fas fa-file-alt"></i> Jina AI文档解析</div>
                        <form id="jina-form" onsubmit="return false;">
                            <div class="form-group">
                                <label class="form-label">API密钥</label>
                                <input type="password" id="jina-api-key" class="form-input" placeholder="输入Jina AI API密钥" autocomplete="off">
                                <small class="form-hint">
                                    用于解析PDF、DOC、PPT、Excel、图片、URL等文档格式。
                                    <a href="https://jina.ai/" target="_blank" rel="noopener">获取API密钥</a>
                                </small>
                            </div>
                            <div class="form-group">
                                <label class="resource-checkbox-item jina-checkbox-item">
                                    <input type="checkbox" id="jina-enabled" checked>
                                    <span class="custom-checkbox"></span>
                                    <span class="checkbox-text">启用Jina AI文档解析</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <div class="info-box">
                                    <strong>支持的格式：</strong>
                                    <ul>
                                        <li>PDF文档（.pdf）</li>
                                        <li>Word文档（.doc, .docx）</li>
                                        <li>PowerPoint（.ppt, .pptx）</li>
                                        <li>Excel表格（.xlsx, .xls）</li>
                                        <li>图片文件（.jpg, .png, .gif等）</li>
                                        <li>网页URL</li>
                                    </ul>
                                    <p><strong>注意：</strong>未配置API密钥时，这些格式将无法解析内容，仅保存文件基本信息。</p>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-primary" id="jina-save-btn">保存配置</button>
                                <button type="button" class="btn btn-secondary" id="jina-test-btn">测试连接</button>
                            </div>
                        </form>
                    </div>

                    <!-- 数据设置 -->
                    <div id="settings-data" class="settings-panel">
                        <div class="settings-section-title"><i class="fas fa-database"></i> 数据管理</div>
                        <div class="data-actions">
                            <button class="btn btn-primary" id="export-data-btn">
                                <i class="fas fa-download"></i> 导出数据
                            </button>
                            <label class="btn btn-secondary">
                                <i class="fas fa-upload"></i> 导入数据
                                <input type="file" id="import-file-input" accept=".json" hidden>
                            </label>
                            <button class="btn btn-danger" id="clear-data-btn">
                                <i class="fas fa-trash"></i> 清除所有数据
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 工具模态框 -->
    <div id="tools-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-toolbox"></i> 工具</h3>
                <button class="modal-close" onclick="AIAgentUI.closeModal('tools-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="tools-grid">
                    <div class="tool-item" data-tool="export-md">
                        <i class="fas fa-file-export"></i>
                        <span>导出Markdown</span>
                    </div>
                    <div class="tool-item" data-tool="export-html">
                        <i class="fas fa-file-code"></i>
                        <span>导出HTML</span>
                    </div>
                    <div class="tool-item" data-tool="export-pdf">
                        <i class="fas fa-file-pdf"></i>
                        <span>导出PDF</span>
                    </div>
                    <div class="tool-item" data-tool="share">
                        <i class="fas fa-share-alt"></i>
                        <span>分享</span>
                    </div>
                    <div class="tool-item" data-tool="copy">
                        <i class="fas fa-copy"></i>
                        <span>复制全部</span>
                    </div>
                    <div class="tool-item" data-tool="clear">
                        <i class="fas fa-eraser"></i>
                        <span>清空对话</span>
                    </div>
                    <div class="tool-item" data-tool="stats">
                        <i class="fas fa-chart-bar"></i>
                        <span>统计</span>
                    </div>
                    <div class="tool-item" data-tool="shortcuts">
                        <i class="fas fa-keyboard"></i>
                        <span>快捷键</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 任务模态框 -->
    <div id="task-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-tasks"></i> 任务管理</h3>
                <button class="modal-close" onclick="AIAgentUI.closeModal('task-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="tasks-list" class="tasks-list"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="AIAgentUI.closeModal('task-modal')">关闭</button>
                <button class="btn btn-primary" id="new-task-btn">
                    <i class="fas fa-plus"></i> 新建任务
                </button>
            </div>
        </div>
    </div>

    <!-- 计划模态框 -->
    <div id="plan-modal" class="modal modal-large">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-calendar-alt"></i> 计划管理</h3>
                <button class="modal-close" onclick="AIAgentUI.closeModal('plan-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="plans-list" class="plans-list"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="AIAgentUI.closeModal('plan-modal')">关闭</button>
                <button class="btn btn-primary" id="new-plan-btn">
                    <i class="fas fa-plus"></i> 新建计划
                </button>
            </div>
        </div>
    </div>

    <!-- Toast通知容器 -->
    <div id="toast-container" class="toast-container"></div>

    <!-- 加载动画 -->
    <div id="loading" class="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- 图片预览 -->
    <div id="preview-image" class="preview-image-modal">
        <img src="" alt="预览">
        <button class="preview-close" onclick="AIAgentUI.closeImagePreview()">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- 隐藏的文件输入 -->
    <input type="file" id="file-input" style="display: none;" multiple accept="*/*">
    <input type="file" id="import-data-btn" style="display: none;" accept=".json">

    <!-- JavaScript Files -->
    <!-- 工具模块 -->
    <script src="js/utils/logger.js"></script>
    <script src="js/utils/error-handler.js"></script>
    <script src="js/utils/event-manager.js"></script>
    <!-- UI工具模块 -->
    <script src="js/ui/ui-utils.js"></script>
    <!-- 核心模块（rag 需在 events 前加载，供文件解析使用） -->
    <script src="js/app.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/rag.js"></script>
    <script src="js/llm.js"></script>
    <script src="js/events.js"></script>
    <script src="js/plan.js"></script>
    <script src="js/sync.js"></script>
</body>
</html>
